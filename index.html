<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aces of Valor - Tactical Dashboard</title>
    <style>
        :root { --bg: #1a1a1a; --card: #2d2d2d; --accent: #d4af37; --text: #e0e0e0; }
        body { font-family: 'Courier New', Courier, monospace; background: var(--bg); color: var(--text); margin: 0; padding: 10px; }
        .header { text-align: center; border-bottom: 2px solid var(--accent); margin-bottom: 20px; padding-bottom: 10px; }
        .tab-container { display: flex; overflow-x: auto; gap: 5px; margin-bottom: 20px; padding-bottom: 5px; }
        .tab { background: var(--card); border: 1px solid var(--accent); color: white; padding: 10px; cursor: pointer; white-space: nowrap; border-radius: 4px; }
        .tab.active { background: var(--accent); color: black; font-weight: bold; }
        .section { display: none; background: var(--card); padding: 15px; border-radius: 8px; border-left: 5px solid var(--accent); }
        .section.active { display: block; }
        .dice-row { display: flex; gap: 10px; align-items: center; margin-bottom: 15px; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 5px; }
        .roll-btn { background: #b22222; color: white; border: none; padding: 12px; border-radius: 5px; cursor: pointer; flex-grow: 1; font-weight: bold; }
        .result-display { font-size: 1.5rem; color: var(--accent); font-weight: bold; min-width: 40px; text-align: center; }
        .table-output { margin-top: 15px; line-height: 1.4; border-top: 1px dashed #555; padding-top: 10px; color: #fff; }
        .modifier-input { width: 50px; padding: 5px; background: #444; color: white; border: 1px solid var(--accent); border-radius: 3px; }
        label { font-size: 0.8rem; text-transform: uppercase; }
    </style>
</head>
<body>

<div class="header">
    <h1>ACES OF VALOR</h1>
    <small>Flight Manual Assistant</small>
</div>

<div class="tab-container">
    <div class="tab active" onclick="showSection('mission')">MISSIONE</div>
    <div class="tab" onclick="showSection('air-air')">AIR-TO-AIR</div>
    <div class="tab" onclick="showSection('combat')">COMBAT</div>
    <div class="tab" onclick="showSection('ground')">GROUND</div>
</div>

<div id="mission" class="section active">
    <h3>Generazione Missione (M-1)</h3>
    <div class="dice-row">
        <label>Mod:</label>
        <input type="number" id="mod-m1" class="modifier-input" value="0">
        <button class="roll-btn" onclick="handleRoll('m1', 10, 'mod-m1')">ROLL D10</button>
        <div id="res-m1" class="result-display">?</div>
    </div>
    <div id="out-m1" class="table-output">Lancia per determinare il tipo di missione...</div>
</div>

<div id="air-air" class="section">
    <h3>Avvistamento (A-1)</h3>
    <div class="dice-row">
        <label>Mod:</label>
        <input type="number" id="mod-a1" class="modifier-input" value="0">
        <button class="roll-btn" onclick="handleRoll('a1', 10, 'mod-a1')">ROLL D10</button>
        <div id="res-a1" class="result-display">?</div>
    </div>
    <div id="out-a1" class="table-output">Lancia per vedere chi avvista chi...</div>
</div>

<div id="combat" class="section">
    <h3>Tiro per Colpire (C-1)</h3>
    <div class="dice-row">
        <label>Mod:</label>
        <input type="number" id="mod-c1" class="modifier-input" value="0">
        <button class="roll-btn" onclick="handleRoll('c1', 10, 'mod-c1')">ROLL D10</button>
        <div id="res-c1" class="result-display">?</div>
    </div>
    <div id="out-c1" class="table-output">Determina se il colpo va a segno...</div>
</div>

<script>
    const data = {
        m1: {
            1: "Patrol (Target: Zone 1)",
            3: "Close Air Support (Target: Frontline)",
            6: "Tactical Bombing (Target: Installation)",
            9: "Escort Mission (Protect Bombers)",
            10: "Special Ops / Recon"
        },
        a1: {
            1: "Automatic Tailing (Vantaggio Totale)",
            3: "Vantaggio: Tu inizi l'attacco",
            6: "Incontro Frontale: Entrambi sparano",
            8: "Svantaggio: Il nemico ti insegue",
            10: "Imboscata Nemica!"
        },
        c1: {
            1: "Mancato (Out of Range/Jam)",
            5: "Colpo di Striscio (1 Danno)",
            8: "Colpo Diretto (2 Danni)",
            10: "Colpo Critico! (Tira su tabella Danni)"
        }
    };

    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    function handleRoll(tableKey, dice, modId) {
        const mod = parseInt(document.getElementById(modId).value) || 0;
        const roll = Math.floor(Math.random() * dice) + 1;
        const total = roll + mod;
        
        document.getElementById('res-' + tableKey).innerText = total;
        
        // Trova il risultato corrispondente nella tabella (approssimazione per difetto)
        let table = data[tableKey];
        let keys = Object.keys(table).map(Number).sort((a,b) => b-a);
        let resultText = "Risultato fuori tabella";
        
        for(let k of keys) {
            if(total >= k) {
                resultText = table[k];
                break;
            }
        }
        document.getElementById('out-' + tableKey).innerHTML = `<strong>TOTALE ${total}:</strong> ${resultText}`;
    }
</script>

</body>
</html>

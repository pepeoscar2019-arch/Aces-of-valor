<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aces of Valor - Campaign Command</title>
    <style>
        :root { --paper: #f0e6d2; --ink: #3b2f21; --military: #556b2f; --accent: #8b0000; }
        body { background: #1a1a1a; color: var(--ink); font-family: 'Courier New', Courier, monospace; padding: 10px; }
        .map-bg { max-width: 800px; margin: auto; background: var(--paper); border: 10px double var(--ink); padding: 20px; border-radius: 2px; position: relative; }
        
        h1, h2 { text-align: center; text-transform: uppercase; letter-spacing: 2px; border-bottom: 2px solid var(--ink); }
        .tab-nav { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-bottom: 20px; }
        .tab-btn { background: var(--military); color: white; border: none; padding: 10px; cursor: pointer; font-size: 0.8em; text-transform: uppercase; }
        .tab-btn.active { background: var(--ink); }

        .section { display: none; }
        .active { display: block; }

        .card { border: 1px solid var(--ink); padding: 10px; margin-bottom: 10px; background: rgba(255,255,255,0.3); }
        .stat-line { display: flex; justify-content: space-between; align-items: center; margin: 5px 0; }
        input, select { background: transparent; border: 1px solid var(--ink); padding: 5px; font-family: inherit; }
        
        .dice-btn { background: var(--accent); color: white; border: none; padding: 10px; width: 100%; cursor: pointer; font-weight: bold; margin-top: 5px; }
        .result-box { background: #fff; border-left: 5px solid var(--accent); padding: 8px; margin-top: 5px; font-weight: bold; min-height: 20px; }
        
        .fleet-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; text-align: center; }
        .counter { font-size: 1.5em; font-weight: bold; }
    </style>
</head>
<body>

<div class="map-bg">
    <h1>Aces of Valor - HQ</h1>
    
    <div class="tab-nav">
        <button class="tab-btn active" onclick="show('setup')">Setup Squadriglia</button>
        <button class="tab-btn" onclick="show('mission')">Missione</button>
        <button class="tab-btn" onclick="show('fleet')">Logistica</button>
    </div>

    <div id="setup" class="section active">
        <div class="card">
            <h2>I) Campagna & Nazionalità</h2>
            <div class="stat-line">
                <label>Lunghezza:</label>
                <select id="camp-len">
                    <option value="8">Corta (8 Missioni)</option>
                    <option value="12">Media (12 Missioni)</option>
                    <option value="16">Lunga (16 Missioni)</option>
                </select>
            </div>
            <div class="stat-line">
                <label>Nazione:</label>
                <select id="nation">
                    <option value="GER">Germania (Luftstreitkräfte)</option>
                    <option value="UK">Gran Bretagna (RFC/RAF)</option>
                    <option value="FR">Francia (Aéronautique Militaire)</option>
                    <option value="US">USA (Air Service)</option>
                </select>
            </div>
            <button class="dice-btn" onclick="rollSquadronAssignment()">Roll S1: Assegnazione Squadriglia (D6)</button>
            <div id="res-s1" class="result-box">Aerei iniziali: -</div>
        </div>

        <div class="card">
            <h2>II) Aeroporto Base (S2)</h2>
            <button class="dice-btn" onclick="rollHomeField()">Roll S2: Posizione Aeroporto (D6)</button>
            <div id="res-s2" class="result-box">Aeroporto di Casa: -</div>
        </div>
    </div>

    <div id="mission" class="section">
        <div class="card">
            <h2>Meteo & Turno</h2>
            <button class="dice-btn" onclick="rollWeather()">Tira Meteo (D6)</button>
            <div id="res-weather" class="result-box">-</div>
        </div>
        <div class="card">
            <h2>Evento Incontro (M2/M3)</h2>
            <button class="dice-btn" onclick="rollEncounter()">Genera Incontro</button>
            <div id="res-enc" class="result-box">-</div>
        </div>
    </div>

    <div id="fleet" class="section">
        <div class="card">
            <h2>Stato Squadriglia</h2>
            <p>Aerei totali iniziali: 8 Fighters</p>
            <div class="fleet-grid">
                <div><div class="counter" id="c-ready">8</div>PRONTI</div>
                <div><div class="counter" id="c-recov">0</div>RIPARAZIONE</div>
                <div><div class="counter" id="c-lost">0</div>PERSI</div>
            </div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px; margin-top:10px;">
                <button onclick="changeFleet('ready', -1)">Danneggia</button>
                <button onclick="changeFleet('recov', -1)">Ripara</button>
            </div>
        </div>
        <div class="card">
            <h2>Victory Points (VP)</h2>
            <div class="stat-line">
                <label>VP Attuali:</label>
                <input type="number" id="vp-track" value="0" style="width: 60px;">
            </div>
        </div>
    </div>

</div>

<script>
    function show(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // --- SETUP: ASSEGNAZIONE SQUADRIGLIA (S1) ---
    function rollSquadronAssignment() {
        const d6 = Math.floor(Math.random() * 6) + 1;
        const nation = document.getElementById('nation').value;
        let plane = "";
        let tier = "";

        if (d6 <= 2) { // Tier 1
            const p = { GER: "Albatros D.III", UK: "Sopwith Pup", FR: "Nieuport 17", US: "Nieuport 17" };
            plane = p[nation];
            tier = "Tier 1 (Gun 4/6, Perf 6, Struct 5)";
        } else if (d6 <= 4) { // Tier 2
            const p = { GER: "Fokker Dr.I", UK: "Sopwith Camel", FR: "SPAD VII", US: "Nieuport 28" };
            plane = p[nation];
            tier = "Tier 2 (Gun 4/6, Perf 7, Struct 5)";
        } else { // Tier 3
            const p = { GER: "Fokker D.VII", UK: "Sopwith Dolphin", FR: "SPAD XIII", US: "SPAD XIII" };
            plane = p[nation];
            tier = "Tier 3 (Gun 4/6, Perf 8, Struct 5)";
        }
        document.getElementById('res-s1').innerHTML = `Tiro: ${d6} <br>Modello: <b>${plane}</b><br><small>${tier}</small>`;
    }

    // --- SETUP: AEROPORTO BASE (S2) ---
    function rollHomeField() {
        const d6 = Math.floor(Math.random() * 6) + 1;
        let field = "";
        if (d6 <= 2) field = "Aeroporto A (Settore Nord)";
        else if (d6 <= 4) field = "Aeroporto B (Settore Centrale)";
        else field = "Aeroporto C (Settore Sud)";
        document.getElementById('res-s2').innerHTML = `Tiro: ${d6} <br><b>${field}</b>`;
    }

    // --- METEO (M1) ---
    function rollWeather() {
        const d6 = Math.floor(Math.random() * 6) + 1;
        let res = "";
        if (d6 <= 2) res = "Sereno: Nessun effetto.";
        else if (d6 <= 4) res = "Nuvole Leggere: -1 Foto/Artiglieria, -1 Atterraggio Difficile.";
        else res = "Nuvole Pesanti: -2 Foto/Artiglieria, -2 Atterraggio Difficile.";
        document.getElementById('res-weather').innerHTML = `Tiro: ${d6} <br><b>${res}</b>`;
    }

    // --- INCONTRI (7.0) ---
    function rollEncounter() {
        const d6 = Math.floor(Math.random() * 6) + 1;
        let res = "";
        if (d6 === 1) res = "Problemi al Motore! (Controlla aereo danneggiato)";
        else if (d6 <= 3) res = "Raid Nemico: Combatti contro D3+1 Caccia nemici!";
        else if (d6 <= 5) res = "Pattuglia Caccia: Incontro con D6 velivoli nemici.";
        else res = "Bersaglio di Terra: Avvistata Fanteria o Carri!";
        document.getElementById('res-enc').innerHTML = `Tiro: ${d6} <br><b>${res}</b>`;
    }

    // --- LOGISTICA FLOTTA ---
    function changeFleet(type, amt) {
        let r = parseInt(document.getElementById('c-ready').innerText);
        let rec = parseInt(document.getElementById('c-recov').innerText);
        let l = parseInt(document.getElementById('c-lost').innerText);

        if (type === 'ready' && r > 0) {
            document.getElementById('c-ready').innerText = r - 1;
            document.getElementById('c-recov').innerText = rec + 1;
        } else if (type === 'recov' && rec > 0) {
            document.getElementById('c-recov').innerText = rec - 1;
            document.getElementById('c-ready').innerText = r + 1;
        }
    }
</script>

</body>
</html>
